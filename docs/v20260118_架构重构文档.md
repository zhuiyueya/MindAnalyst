### 1. Prompt 工程化管理 (Prompt Management)
将硬编码在代码中的 Prompt 字符串抽离出来，像管理代码一样管理 Prompt。

建议方案：

- 独立目录 ：建立 src/prompts/ 目录。
- 文件格式 ：使用 YAML 或 Jinja2 模板文件，便于阅读和编辑。
- 版本控制 ：在文件名或目录中体现版本（如 v1 ），支持快速回滚和 A/B 测试。
- 加载器 ：实现一个 PromptManager 类，负责读取、缓存和渲染模板。
目录示例：

```
src/prompts/
├── manager.py           # 负责加载和渲染 
Prompt
└── templates/
    ├── video_summary/
    │   ├── v1.yaml      # 初始版本
    │   └── v2.yaml      # 优化了 JSON 输出
    约束的版本
    ├── author_report/
    │   └── v1.yaml
    └── rag_chat/
        ├── system_v1.yaml
        └── user_v1.yaml
```
YAML 文件示例 ( video_summary/v1.yaml )：

```
version: "1.0"
description: "单视频结构化摘要生成"
system: |
  你是一个专业的视频内容分析师。请对提供的视频转
  写文本进行结构化总结。
  输出必须是合法的 JSON 格式...
user: |
  视频内容如下：
  {{ context }}
```
### 2. 项目目录结构优化 (Directory Restructuring)
建议从目前的“按技术层分包”（crawler/services/models）转向**“领域驱动 + 清洁架构”**的混合模式，以适应未来的多平台（Sources）和多功能（RAG/Analysis）。

推荐的新结构：

```
src/
├── api/                 # [接口层] 
FastAPI 路由
│   ├── v1/
│   └── deps.py
├── core/                # [核心层] 配置、日
志、异常定义
│   ├── config.py
│   └── logger.py
├── database/            # [数据层] DB 连
接、Session
├── models/              # [模型层] 数据库 
ORM 模型 (可按领域拆分文件)
│   ├── content.py
│   ├── author.py
│   └── analysis.py
├── prompts/             # [Prompt层] 提示
词管理 (如上所述)
│
├── adapters/            # [适配器层] 负责与
外部平台/服务交互 (原 crawler + services)
│   ├── sources/         # 数据源适配器 (标
准化接口)
│   │   ├── base.py      # 定义 
SourceBase 基类
│   │   ├── bilibili/    # B站相关实现 
(Bilix, Browser)
│   │   └── wechat/      # (未来) 公众号实现
│   ├── llm/             # LLM 服务适配 
(SiliconFlow, OpenAI)
│   ├── storage/         # 对象存储适配 
(MinIO, S3)
│   └── asr/             # ASR 服务适配
│
├── workflows/           # [业务编排层] 核心
业务流程 (原 pipeline.py 的拆解)
│   ├── ingestion.py     # 采集入库流程 (调
用 adapters.sources)
│   ├── analysis.py      # 分析流程 (调用 
adapters.llm 生成摘要/报告)
│   └── maintenance.py   # 数据回填、清理任
务
│
└── rag/                 # [RAG 引擎层] 检
索与问答核心 (原 chat.py)
    ├── engine.py        # 聊天主逻辑
    ├── retrieval.py     # 召回 (Vector + 
    Keyword)
    └── rerank.py        # 重排
```
### 3. 为什么这样改？
1. 解耦数据源 ( adapters/sources ) ：未来接入公众号或网页时，只需在 sources 下新增一个目录实现 fetch_content 接口，而不需要修改核心的 workflows 或 rag 逻辑。
2. 清晰的业务流 ( workflows ) ： pipeline.py 目前太杂了，拆分为 ingestion （只管抓取入库）和 analysis （只管 LLM 分析），职责更单一，方便断点续跑和独立重试。
3. Prompt 独立 ( prompts ) ：非开发人员（或 Prompt 工程师）可以直接修改 YAML 文件来优化效果，而无需触碰 Python 代码。